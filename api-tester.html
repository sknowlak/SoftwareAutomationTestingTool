<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Betaboss API Tester</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap" />
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f5f5f5;
            color: #333;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        header {
            background-color: #2196f3;
            color: white;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 {
            margin: 0;
            font-size: 24px;
        }
        .main-content {
            display: flex;
            margin-top: 20px;
            gap: 20px;
        }
        .request-panel {
            flex: 1;
            background: white;
            border-radius: 4px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.12);
            padding: 20px;
        }
        .response-panel {
            flex: 1;
            background: white;
            border-radius: 4px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.12);
            padding: 20px;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }
        input, select, textarea {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            box-sizing: border-box;
        }
        select {
            height: 38px;
        }
        textarea {
            min-height: 100px;
            font-family: monospace;
        }
        .url-container {
            display: flex;
            gap: 10px;
        }
        .method-select {
            width: 120px;
            flex-shrink: 0;
        }
        .button {
            background-color: #2196f3;
            color: white;
            border: none;
            padding: 10px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            transition: background-color 0.3s;
        }
        .button:hover {
            background-color: #1976d2;
        }
        .button-container {
            display: flex;
            justify-content: flex-end;
            margin-top: 20px;
        }
        .tabs {
            display: flex;
            border-bottom: 1px solid #ddd;
            margin-bottom: 15px;
        }
        .tab {
            padding: 10px 15px;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            font-weight: 500;
        }
        .tab.active {
            border-bottom-color: #2196f3;
            color: #2196f3;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .key-value-pair {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }
        .key-value-pair input {
            flex: 1;
        }
        .add-button {
            background-color: #4caf50;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            margin-bottom: 10px;
        }
        .remove-button {
            background-color: #f44336;
            color: white;
            border: none;
            width: 30px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }
        .response-info {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            gap: 15px;
        }
        .status {
            font-weight: bold;
            padding: 5px 10px;
            border-radius: 4px;
            color: white;
        }
        .status.success {
            background-color: #4caf50;
        }
        .status.error {
            background-color: #f44336;
        }
        .status.warning {
            background-color: #ff9800;
        }
        .response-body {
            background-color: #f5f5f5;
            padding: 15px;
            border-radius: 4px;
            font-family: monospace;
            white-space: pre-wrap;
            overflow-x: auto;
            max-height: 400px;
            overflow-y: auto;
        }
        .curl-input {
            width: 100%;
            padding: 10px;
            font-family: monospace;
            margin-bottom: 10px;
        }
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 200px;
        }
        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-radius: 50%;
            border-top: 4px solid #2196f3;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .json-formatter {
            color: #333;
            white-space: pre-wrap;
            font-family: monospace;
        }
        .json-key {
            color: #881391;
        }
        .json-string {
            color: #1a1aa6;
        }
        .json-number {
            color: #1c00cf;
        }
        .json-boolean {
            color: #0d22aa;
        }
        .json-null {
            color: #808080;
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <h1>Betaboss API Tester</h1>
        </div>
    </header>

    <div class="container">
        <div class="main-content">
            <div class="request-panel">
                <h2>Request</h2>
                
                <div class="tabs">
                    <div class="tab active" data-tab="request-builder">Builder</div>
                    <div class="tab" data-tab="curl-importer">cURL Import</div>
                </div>
                
                <div class="tab-content active" id="request-builder">
                    <div class="form-group url-container">
                        <select id="method" class="method-select">
                            <option value="GET">GET</option>
                            <option value="POST">POST</option>
                            <option value="PUT">PUT</option>
                            <option value="DELETE">DELETE</option>
                            <option value="PATCH">PATCH</option>
                            <option value="HEAD">HEAD</option>
                            <option value="OPTIONS">OPTIONS</option>
                        </select>
                        <input type="text" id="url" placeholder="https://api.example.com/endpoint" value="https://jsonplaceholder.typicode.com/posts/1">
                    </div>
                    
                    <div class="tabs">
                        <div class="tab active" data-tab="params">Params</div>
                        <div class="tab" data-tab="headers">Headers</div>
                        <div class="tab" data-tab="body">Body</div>
                    </div>
                    
                    <div class="tab-content active" id="params">
                        <div id="params-container">
                            <!-- Params will be added here -->
                        </div>
                        <button class="add-button" id="add-param">Add Parameter</button>
                    </div>
                    
                    <div class="tab-content" id="headers">
                        <div id="headers-container">
                            <!-- Headers will be added here -->
                        </div>
                        <button class="add-button" id="add-header">Add Header</button>
                    </div>
                    
                    <div class="tab-content" id="body">
                        <div class="form-group">
                            <label for="request-body">Request Body</label>
                            <textarea id="request-body" placeholder="Enter request body (JSON, XML, etc.)"></textarea>
                        </div>
                    </div>
                </div>
                
                <div class="tab-content" id="curl-importer">
                    <div class="form-group">
                        <label for="curl-command">cURL Command</label>
                        <textarea id="curl-command" class="curl-input" placeholder="Enter cURL command"></textarea>
                        <button class="button" id="import-curl">Import</button>
                    </div>
                </div>
                
                <div class="button-container">
                    <button class="button" id="send-request">Send Request</button>
                </div>
            </div>
            
            <div class="response-panel">
                <h2>Response</h2>
                
                <div id="loading" class="loading" style="display: none;">
                    <div class="spinner"></div>
                </div>
                
                <div id="response-container" style="display: none;">
                    <div class="response-info">
                        <div id="status" class="status">Status: 200 OK</div>
                        <div id="time">Time: 0ms</div>
                        <div id="size">Size: 0 bytes</div>
                    </div>
                    
                    <div class="tabs">
                        <div class="tab active" data-tab="response-body">Body</div>
                        <div class="tab" data-tab="response-headers">Headers</div>
                    </div>
                    
                    <div class="tab-content active" id="response-body">
                        <pre id="response-body-content" class="response-body"></pre>
                    </div>
                    
                    <div class="tab-content" id="response-headers">
                        <pre id="response-headers-content" class="response-body"></pre>
                    </div>
                </div>
                
                <div id="no-response" style="text-align: center; padding: 50px 0;">
                    <p>Send a request to see the response</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Tab switching
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                // Get the parent tabs container
                const tabsContainer = tab.parentElement;
                // Get all tabs in this container
                const tabs = tabsContainer.querySelectorAll('.tab');
                // Remove active class from all tabs
                tabs.forEach(t => t.classList.remove('active'));
                // Add active class to clicked tab
                tab.classList.add('active');
                
                // Get the tab content id
                const tabId = tab.getAttribute('data-tab');
                
                // If this is a main tab (request-builder or curl-importer)
                if (tabId === 'request-builder' || tabId === 'curl-importer') {
                    document.querySelectorAll('#request-builder, #curl-importer').forEach(content => {
                        content.classList.remove('active');
                    });
                    document.getElementById(tabId).classList.add('active');
                } 
                // If this is a request tab (params, headers, body)
                else if (tabId === 'params' || tabId === 'headers' || tabId === 'body') {
                    document.querySelectorAll('#params, #headers, #body').forEach(content => {
                        content.classList.remove('active');
                    });
                    document.getElementById(tabId).classList.add('active');
                }
                // If this is a response tab (response-body, response-headers)
                else if (tabId === 'response-body' || tabId === 'response-headers') {
                    document.querySelectorAll('#response-body, #response-headers').forEach(content => {
                        content.classList.remove('active');
                    });
                    document.getElementById(tabId).classList.add('active');
                }
            });
        });
        
        // Add parameter
        document.getElementById('add-param').addEventListener('click', () => {
            addKeyValuePair('params-container', 'param');
        });
        
        // Add header
        document.getElementById('add-header').addEventListener('click', () => {
            addKeyValuePair('headers-container', 'header');
        });
        
        // Function to add key-value pair
        function addKeyValuePair(containerId, type) {
            const container = document.getElementById(containerId);
            const pairId = Date.now();
            
            const pairDiv = document.createElement('div');
            pairDiv.className = 'key-value-pair';
            pairDiv.innerHTML = `
                <input type="text" placeholder="Key" class="${type}-key" data-pair-id="${pairId}">
                <input type="text" placeholder="Value" class="${type}-value" data-pair-id="${pairId}">
                <button class="remove-button" data-pair-id="${pairId}">×</button>
            `;
            
            container.appendChild(pairDiv);
            
            // Add event listener to remove button
            pairDiv.querySelector('.remove-button').addEventListener('click', (e) => {
                const pairId = e.target.getAttribute('data-pair-id');
                const pairToRemove = container.querySelector(`.key-value-pair:has([data-pair-id="${pairId}"])`);
                if (pairToRemove) {
                    container.removeChild(pairToRemove);
                }
            });
        }
        
        // Send request
        document.getElementById('send-request').addEventListener('click', async () => {
            // Show loading
            document.getElementById('loading').style.display = 'flex';
            document.getElementById('response-container').style.display = 'none';
            document.getElementById('no-response').style.display = 'none';
            
            try {
                // Get request details
                const method = document.getElementById('method').value;
                let url = document.getElementById('url').value;
                const body = document.getElementById('request-body').value;
                
                // Get parameters
                const params = [];
                document.querySelectorAll('.param-key').forEach(keyInput => {
                    const pairId = keyInput.getAttribute('data-pair-id');
                    const key = keyInput.value.trim();
                    const valueInput = document.querySelector(`.param-value[data-pair-id="${pairId}"]`);
                    const value = valueInput ? valueInput.value.trim() : '';
                    
                    if (key) {
                        params.push({ key, value });
                    }
                });
                
                // Add parameters to URL
                if (params.length > 0) {
                    const urlObj = new URL(url);
                    params.forEach(param => {
                        urlObj.searchParams.append(param.key, param.value);
                    });
                    url = urlObj.toString();
                }
                
                // Get headers
                const headers = {};
                document.querySelectorAll('.header-key').forEach(keyInput => {
                    const pairId = keyInput.getAttribute('data-pair-id');
                    const key = keyInput.value.trim();
                    const valueInput = document.querySelector(`.header-value[data-pair-id="${pairId}"]`);
                    const value = valueInput ? valueInput.value.trim() : '';
                    
                    if (key) {
                        headers[key] = value;
                    }
                });
                
                // Add content-type header for JSON body if not already set
                if (body && !headers['Content-Type'] && !headers['content-type']) {
                    try {
                        JSON.parse(body);
                        headers['Content-Type'] = 'application/json';
                    } catch (e) {
                        // Not JSON, don't set content-type
                    }
                }
                
                // Start timing
                const startTime = performance.now();
                
                // Make the request
                const response = await fetch(url, {
                    method,
                    headers,
                    body: method !== 'GET' && body ? body : undefined,
                    mode: 'cors',
                    credentials: 'omit'
                });
                
                // End timing
                const endTime = performance.now();
                const duration = Math.round(endTime - startTime);
                
                // Get response headers
                const responseHeaders = {};
                response.headers.forEach((value, key) => {
                    responseHeaders[key] = value;
                });
                
                // Get response body
                let responseBody = '';
                const contentType = response.headers.get('content-type');
                
                if (contentType && contentType.includes('application/json')) {
                    try {
                        const jsonBody = await response.json();
                        responseBody = JSON.stringify(jsonBody, null, 2);
                    } catch (error) {
                        responseBody = await response.text();
                    }
                } else {
                    responseBody = await response.text();
                }
                
                // Calculate response size
                const size = new Blob([responseBody]).size;
                
                // Update UI
                document.getElementById('status').textContent = `Status: ${response.status} ${response.statusText}`;
                document.getElementById('status').className = `status ${getStatusClass(response.status)}`;
                document.getElementById('time').textContent = `Time: ${duration}ms`;
                document.getElementById('size').textContent = `Size: ${formatBytes(size)}`;
                
                // Format and display response body
                const responseBodyElement = document.getElementById('response-body-content');
                if (contentType && contentType.includes('application/json')) {
                    try {
                        responseBodyElement.innerHTML = formatJSON(responseBody);
                    } catch (e) {
                        responseBodyElement.textContent = responseBody;
                    }
                } else {
                    responseBodyElement.textContent = responseBody;
                }
                
                // Format and display response headers
                const responseHeadersElement = document.getElementById('response-headers-content');
                responseHeadersElement.textContent = Object.entries(responseHeaders)
                    .map(([key, value]) => `${key}: ${value}`)
                    .join('\n');
                
                // Show response
                document.getElementById('loading').style.display = 'none';
                document.getElementById('response-container').style.display = 'block';
                document.getElementById('no-response').style.display = 'none';
                
            } catch (error) {
                console.error('Error making request:', error);
                
                // Update UI with error
                document.getElementById('status').textContent = `Error: ${error.message}`;
                document.getElementById('status').className = 'status error';
                document.getElementById('time').textContent = 'Time: 0ms';
                document.getElementById('size').textContent = 'Size: 0 bytes';
                document.getElementById('response-body-content').textContent = error.stack || error.message;
                document.getElementById('response-headers-content').textContent = '';
                
                // Show response
                document.getElementById('loading').style.display = 'none';
                document.getElementById('response-container').style.display = 'block';
                document.getElementById('no-response').style.display = 'none';
            }
        });
        
        // Import cURL command
        document.getElementById('import-curl').addEventListener('click', () => {
            const curlCommand = document.getElementById('curl-command').value.trim();
            if (!curlCommand) return;
            
            try {
                // Simple cURL parser (this is a basic implementation)
                const parsedRequest = parseCurlCommand(curlCommand);
                
                // Update UI with parsed request
                document.getElementById('method').value = parsedRequest.method;
                document.getElementById('url').value = parsedRequest.url;
                document.getElementById('request-body').value = parsedRequest.body || '';
                
                // Clear existing params and headers
                document.getElementById('params-container').innerHTML = '';
                document.getElementById('headers-container').innerHTML = '';
                
                // Add params
                parsedRequest.params.forEach(param => {
                    const container = document.getElementById('params-container');
                    const pairId = Date.now() + Math.random();
                    
                    const pairDiv = document.createElement('div');
                    pairDiv.className = 'key-value-pair';
                    pairDiv.innerHTML = `
                        <input type="text" placeholder="Key" class="param-key" data-pair-id="${pairId}" value="${escapeHtml(param.key)}">
                        <input type="text" placeholder="Value" class="param-value" data-pair-id="${pairId}" value="${escapeHtml(param.value)}">
                        <button class="remove-button" data-pair-id="${pairId}">×</button>
                    `;
                    
                    container.appendChild(pairDiv);
                    
                    // Add event listener to remove button
                    pairDiv.querySelector('.remove-button').addEventListener('click', (e) => {
                        const pairId = e.target.getAttribute('data-pair-id');
                        const pairToRemove = container.querySelector(`.key-value-pair:has([data-pair-id="${pairId}"])`);
                        if (pairToRemove) {
                            container.removeChild(pairToRemove);
                        }
                    });
                });
                
                // Add headers
                parsedRequest.headers.forEach(header => {
                    const container = document.getElementById('headers-container');
                    const pairId = Date.now() + Math.random();
                    
                    const pairDiv = document.createElement('div');
                    pairDiv.className = 'key-value-pair';
                    pairDiv.innerHTML = `
                        <input type="text" placeholder="Key" class="header-key" data-pair-id="${pairId}" value="${escapeHtml(header.key)}">
                        <input type="text" placeholder="Value" class="header-value" data-pair-id="${pairId}" value="${escapeHtml(header.value)}">
                        <button class="remove-button" data-pair-id="${pairId}">×</button>
                    `;
                    
                    container.appendChild(pairDiv);
                    
                    // Add event listener to remove button
                    pairDiv.querySelector('.remove-button').addEventListener('click', (e) => {
                        const pairId = e.target.getAttribute('data-pair-id');
                        const pairToRemove = container.querySelector(`.key-value-pair:has([data-pair-id="${pairId}"])`);
                        if (pairToRemove) {
                            container.removeChild(pairToRemove);
                        }
                    });
                });
                
                // Switch to request builder tab
                document.querySelector('.tab[data-tab="request-builder"]').click();
                
            } catch (error) {
                console.error('Error parsing cURL command:', error);
                alert(`Error parsing cURL command: ${error.message}`);
            }
        });
        
        // Helper functions
        function getStatusClass(status) {
            if (status >= 200 && status < 300) return 'success';
            if (status >= 400) return 'error';
            return 'warning';
        }
        
        function formatBytes(bytes) {
            if (bytes === 0) return '0 Bytes';
            
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }
        
        function formatJSON(json) {
            try {
                const obj = JSON.parse(json);
                return syntaxHighlight(obj);
            } catch (e) {
                return json;
            }
        }
        
        function syntaxHighlight(obj) {
            const json = JSON.stringify(obj, null, 2);
            return json.replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g, function (match) {
                let cls = 'json-number';
                if (/^"/.test(match)) {
                    if (/:$/.test(match)) {
                        cls = 'json-key';
                        match = match.replace(/"/g, '').replace(/:$/, '');
                        return `<span class="${cls}">"${match}"</span>:`;
                    } else {
                        cls = 'json-string';
                    }
                } else if (/true|false/.test(match)) {
                    cls = 'json-boolean';
                } else if (/null/.test(match)) {
                    cls = 'json-null';
                }
                return `<span class="${cls}">${match}</span>`;
            });
        }
        
        function escapeHtml(unsafe) {
            return unsafe
                .replace(/&/g, "&amp;")
                .replace(/</g, "&lt;")
                .replace(/>/g, "&gt;")
                .replace(/"/g, "&quot;")
                .replace(/'/g, "&#039;");
        }
        
        // Simple cURL parser
        function parseCurlCommand(curlCommand) {
            // Default values
            const result = {
                method: 'GET',
                url: '',
                headers: [],
                params: [],
                body: ''
            };
            
            // Remove 'curl' from the beginning if present
            if (curlCommand.toLowerCase().startsWith('curl ')) {
                curlCommand = curlCommand.substring(5);
            }
            
            // Handle line continuations
            curlCommand = curlCommand.replace(/\\\n/g, ' ').replace(/\\\r\n/g, ' ');
            
            // Split by spaces, respecting quotes
            const tokens = [];
            let currentToken = '';
            let inQuotes = false;
            let escapeNext = false;
            
            for (let i = 0; i < curlCommand.length; i++) {
                const char = curlCommand[i];
                
                if (escapeNext) {
                    currentToken += char;
                    escapeNext = false;
                } else if (char === '\\') {
                    escapeNext = true;
                } else if (char === '"' && !inQuotes) {
                    inQuotes = true;
                } else if (char === '"' && inQuotes) {
                    inQuotes = false;
                } else if (char === ' ' && !inQuotes) {
                    if (currentToken) {
                        tokens.push(currentToken);
                        currentToken = '';
                    }
                } else {
                    currentToken += char;
                }
            }
            
            if (currentToken) {
                tokens.push(currentToken);
            }
            
            // Parse tokens
            for (let i = 0; i < tokens.length; i++) {
                const token = tokens[i];
                
                // Method
                if (token === '-X' || token === '--request') {
                    if (i + 1 < tokens.length) {
                        result.method = tokens[++i].toUpperCase();
                    }
                }
                // URL
                else if (token.startsWith('http://') || token.startsWith('https://')) {
                    result.url = token;
                    
                    // Extract query parameters
                    if (token.includes('?')) {
                        const [baseUrl, queryString] = token.split('?', 2);
                        result.url = baseUrl;
                        
                        queryString.split('&').forEach(param => {
                            if (param.includes('=')) {
                                const [key, value] = param.split('=', 2);
                                result.params.push({ key, value: decodeURIComponent(value) });
                            }
                        });
                    }
                }
                // Headers
                else if (token === '-H' || token === '--header') {
                    if (i + 1 < tokens.length) {
                        const header = tokens[++i];
                        if (header.includes(':')) {
                            const [key, ...valueParts] = header.split(':');
                            const value = valueParts.join(':').trim();
                            result.headers.push({ key: key.trim(), value });
                        }
                    }
                }
                // Data
                else if (token === '-d' || token === '--data' || token === '--data-raw' || token === '--data-binary') {
                    if (i + 1 < tokens.length) {
                        result.body = tokens[++i];
                        if (result.method === 'GET') {
                            result.method = 'POST';
                        }
                    }
                }
                // Data with equals sign
                else if (token.startsWith('--data=') || token.startsWith('--data-raw=') || token.startsWith('-d=')) {
                    result.body = token.split('=', 2)[1];
                    if (result.method === 'GET') {
                        result.method = 'POST';
                    }
                }
            }
            
            return result;
        }
        
        // Initialize with some default headers
        addKeyValuePair('headers-container', 'header');
        document.querySelector('.header-key[data-pair-id]').value = 'Content-Type';
        document.querySelector('.header-value[data-pair-id]').value = 'application/json';
    </script>
</body>
</html>
